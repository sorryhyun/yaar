<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word Lite</title>
<style>*{margin:0;padding:0;box-sizing:border-box}html,body{width:100%;height:100%;overflow:hidden}body{font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}</style>
<script>(function(){if(window.__yaarCaptureInstalled)return;window.__yaarCaptureInstalled=!0;function o(r,e){window.parent.postMessage({type:"yaar:capture-response",requestId:r,imageData:e},"*")}function s(r,e){for(var t=r.querySelectorAll("*"),d=e.querySelectorAll("*"),c=0;c<t.length&&c<d.length;c++){var u=window.getComputedStyle(t[c]);d[c].setAttribute("style",u.cssText)}var n=window.getComputedStyle(r);e.setAttribute("style",n.cssText)}function a(r,e,t,d){var c=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),u=URL.createObjectURL(c),n=new Image;n.onload=function(){var f=document.createElement("canvas");f.width=e,f.height=t;var i=f.getContext("2d");i.drawImage(n,0,0,e,t),URL.revokeObjectURL(u),d(f.toDataURL("image/png"))},n.onerror=function(){URL.revokeObjectURL(u),d(null)},n.src=u}window.addEventListener("message",function(r){if(!(!r.data||r.data.type!=="yaar:capture-request")){var e=r.data.requestId,t=null;try{var d=document.querySelectorAll("canvas");if(d.length>0){for(var c=null,u=0,n=0;n<d.length;n++){var f=d[n].width*d[n].height;f>u&&(u=f,c=d[n])}c&&(t=c.toDataURL("image/png"))}if(t){o(e,t);return}var i=document.querySelectorAll("svg");if(i.length>0){for(var c=null,u=0,n=0;n<i.length;n++){var l=i[n].getBoundingClientRect(),f=l.width*l.height;f>u&&(u=f,c=i[n])}if(c){var y=new XMLSerializer,w=y.serializeToString(c),l=c.getBoundingClientRect();a(w,l.width||300,l.height||150,function(j){o(e,j)});return}}var p=document.body;if(p){var g=Math.min(p.scrollWidth,window.innerWidth)||window.innerWidth||800,m=Math.min(p.scrollHeight,window.innerHeight)||window.innerHeight||600,h=p.cloneNode(!0);s(p,h);for(var v=h.querySelectorAll("script,iframe"),n=0;n<v.length;n++)v[n].remove();var q="http://www.w3.org/1999/xhtml",I="http://www.w3.org/2000/svg",b=new XMLSerializer().serializeToString(h),w='<svg xmlns="'+I+'" width="'+g+'" height="'+m+'"><foreignObject width="100%" height="100%"><body xmlns="'+q+'" style="margin:0;padding:0;">'+b+"</body></foreignObject></svg>";a(w,g,m,function(S){o(e,S)});return}}catch{}o(e,null)}})})(),function(){if(window.__yaarStorageInstalled)return;window.__yaarStorageInstalled=!0;function o(s){return s.split("/").map(encodeURIComponent).join("/")}window.yaar=window.yaar||{},window.yaar.storage={async save(s,a){var r;typeof a=="string"?r=a:a instanceof Blob?r=await a.arrayBuffer():a instanceof ArrayBuffer?r=a:a instanceof Uint8Array?r=a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength):r=String(a);var e=await fetch("/api/storage/"+o(s),{method:"POST",body:r});if(!e.ok){var t=await e.json().catch(function(){return{error:e.statusText}});throw new Error(t.error||"Save failed")}return e.json()},async read(s,a){var r=a&&a.as||"auto",e=await fetch("/api/storage/"+o(s));if(!e.ok){var t=await e.json().catch(function(){return{error:e.statusText}});throw new Error(t.error||"Read failed")}if(r==="blob")return e.blob();if(r==="arraybuffer")return e.arrayBuffer();if(r==="json")return e.json();if(r==="text")return e.text();var d=e.headers.get("content-type")||"";return d.includes("json")?e.json():d.startsWith("text/")?e.text():e.blob()},async list(s){var a=s?o(s):"",r=await fetch("/api/storage/"+a+"?list=true");if(!r.ok){var e=await r.json().catch(function(){return{error:r.statusText}});throw new Error(e.error||"List failed")}return r.json()},async remove(s){var a=await fetch("/api/storage/"+o(s),{method:"DELETE"});if(!a.ok){var r=await a.json().catch(function(){return{error:a.statusText}});throw new Error(r.error||"Delete failed")}return a.json()},url:function(s){return"/api/storage/"+o(s)}}}(),function(){if(!window.__yaarFetchProxyInstalled){window.__yaarFetchProxyInstalled=!0;var o=window.fetch.bind(window),s="";try{var a=new URLSearchParams(location.search),r=a.get("sessionId")||"";/^[a-zA-Z0-9_-]+$/.test(r)&&(s=r)}catch{}window.fetch=function(e,t){var d;if(e instanceof Request?d=e.url:d=String(e),d.startsWith("/")||d.startsWith("./")||d.startsWith("../"))return o(e,t);try{var c=new URL(d,location.origin);if(c.origin===location.origin)return o(e,t)}catch{return o(e,t)}var u=t&&t.method||(e instanceof Request?e.method:"GET"),n={};t&&t.headers?t.headers instanceof Headers?t.headers.forEach(function(i,l){n[l]=i}):Array.isArray(t.headers)?t.headers.forEach(function(i){n[i[0]]=i[1]}):n=Object.assign({},t.headers):e instanceof Request&&e.headers.forEach(function(i,l){n[l]=i});var f;return t&&t.body!=null?typeof t.body=="string"?f=Promise.resolve(t.body):f=new Response(t.body).text():e instanceof Request&&u!=="GET"&&u!=="HEAD"?f=e.text():f=Promise.resolve(void 0),f.then(function(i){var l={url:d,method:u,headers:n};return i!==void 0&&(l.body=i),s&&(l.sessionId=s),o("/api/fetch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})}).then(function(i){return i.ok?i.json():i.json().then(function(l){throw new Error(l.error||"Fetch proxy error: "+i.status)})}).then(function(i){var l;if(i.bodyEncoding==="base64"){for(var y=atob(i.body),w=new Uint8Array(y.length),p=0;p<y.length;p++)w[p]=y.charCodeAt(p);l=w.buffer}else l=i.body;return new Response(l,{status:i.status,statusText:i.statusText,headers:i.headers})})}}}(),function(){if(!window.__yaarAppProtocolInstalled){window.__yaarAppProtocolInstalled=!0,window.yaar=window.yaar||{};var o=null;window.yaar.app={register:function(s){o=s,window.parent.postMessage({type:"yaar:app-ready",appId:s.appId},"*")},sendInteraction:function(s){window.parent.postMessage({type:"yaar:app-interaction",content:typeof s=="string"?s:JSON.stringify(s)},"*")}},window.addEventListener("message",function(s){if(!(!s.data||!s.data.type)){var a=s.data,r=a.requestId;if(a.type==="yaar:app-manifest-request"){if(!o){window.parent.postMessage({type:"yaar:app-manifest-response",requestId:r,manifest:null,error:"No app registered"},"*");return}var e={appId:o.appId,name:o.name,state:{},commands:{}};if(o.state)for(var t in o.state){var d=o.state[t];e.state[t]={description:d.description},d.schema&&(e.state[t].schema=d.schema)}if(o.commands)for(var t in o.commands){var c=o.commands[t];e.commands[t]={description:c.description},c.params&&(e.commands[t].params=c.params),c.returns&&(e.commands[t].returns=c.returns)}window.parent.postMessage({type:"yaar:app-manifest-response",requestId:r,manifest:e},"*");return}if(a.type==="yaar:app-query-request"){if(!o||!o.state||!o.state[a.stateKey]){window.parent.postMessage({type:"yaar:app-query-response",requestId:r,data:null,error:"Unknown state key: "+a.stateKey},"*");return}try{var u=o.state[a.stateKey].handler();u&&typeof u.then=="function"?u.then(function(n){window.parent.postMessage({type:"yaar:app-query-response",requestId:r,data:n},"*")}).catch(function(n){window.parent.postMessage({type:"yaar:app-query-response",requestId:r,data:null,error:String(n)},"*")}):window.parent.postMessage({type:"yaar:app-query-response",requestId:r,data:u},"*")}catch(n){window.parent.postMessage({type:"yaar:app-query-response",requestId:r,data:null,error:String(n)},"*")}return}if(a.type==="yaar:app-command-request"){if(!o||!o.commands||!o.commands[a.command]){window.parent.postMessage({type:"yaar:app-command-response",requestId:r,result:null,error:"Unknown command: "+a.command},"*");return}try{var u=o.commands[a.command].handler(a.params);u&&typeof u.then=="function"?u.then(function(f){window.parent.postMessage({type:"yaar:app-command-response",requestId:r,result:f},"*")}).catch(function(f){window.parent.postMessage({type:"yaar:app-command-response",requestId:r,result:null,error:String(f)},"*")}):window.parent.postMessage({type:"yaar:app-command-response",requestId:r,result:u},"*")}catch(n){window.parent.postMessage({type:"yaar:app-command-response",requestId:r,result:null,error:String(n)},"*")}return}}})}}();</script>
</head>
<body>
<div id="app"></div>
<script type="module">
var B=`
:root {
  --bg: #0f172a;
  --panel: #111827;
  --toolbar: #1f2937;
  --surface: #ffffff;
  --text: #111827;
  --muted: #6b7280;
  --accent: #2563eb;
  --border: #e5e7eb;
}

* { box-sizing: border-box; }
html, body {
  margin: 0;
  height: 100%;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: var(--bg);
}

#app {
  height: 100%;
}

.app-shell {
  display: grid;
  grid-template-rows: auto auto 1fr auto;
  height: 100%;
  color: #e5e7eb;
}

.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  background: var(--panel);
  border-bottom: 1px solid #374151;
}

.brand {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 700;
}

.doc-meta {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

#doc-title {
  min-width: 220px;
}

.brand-badge {
  width: 26px;
  height: 26px;
  border-radius: 7px;
  background: linear-gradient(135deg, #3b82f6, #1d4ed8);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 13px;
}

.toolbar {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  padding: 10px 12px;
  background: var(--toolbar);
  border-bottom: 1px solid #374151;
}

.group {
  display: inline-flex;
  gap: 6px;
  padding-right: 8px;
  margin-right: 4px;
  border-right: 1px solid #374151;
}

.group:last-child {
  border-right: 0;
  padding-right: 0;
}

button, select, input {
  border: 1px solid #4b5563;
  background: #111827;
  color: #f3f4f6;
  border-radius: 8px;
  padding: 6px 10px;
  font-size: 13px;
  cursor: pointer;
}

button:hover, select:hover, input:hover {
  border-color: #9ca3af;
}

button.primary {
  background: var(--accent);
  border-color: #1e40af;
}

.editor-wrap {
  overflow: auto;
  padding: 24px;
  background: #0b1220;
}

.page {
  max-width: 860px;
  min-height: calc(100% - 4px);
  margin: 0 auto;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  box-shadow: 0 10px 24px rgba(0,0,0,0.22);
  color: var(--text);
  padding: 36px 44px;
  outline: none;
  line-height: 1.5;
  font-size: 16px;
  cursor: text;
}

.page a,
.page a:link,
.page a:visited,
.page a:hover,
.page a:active,
.page a:focus,
.page a * {
  cursor: pointer !important;
}

.page a:hover {
  text-decoration: underline;
}

.page:empty:before {
  content: attr(data-placeholder);
  color: #9ca3af;
}

.statusbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background: var(--panel);
  border-top: 1px solid #374151;
  color: #d1d5db;
  font-size: 12px;
}

#app.focus-mode .topbar,
#app.focus-mode .toolbar,
#app.focus-mode .statusbar {
  display: none;
}

#app.focus-mode .editor-wrap {
  padding: 12px;
}

.muted {
  color: var(--muted);
}
`;var E="word-lite-document-v2",k="word-lite-document-v1";function P(t,e=500){let n=null;return(...r)=>{n&&window.clearTimeout(n),n=window.setTimeout(()=>t(...r),e)}}function D(t){let e=t.trim();return{words:e?e.split(/\s+/).length:0,chars:t.length}}function C(t,e){let n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function M(t,e,n){C(t,new Blob([e],{type:n}))}function L(){return new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function F(t){let e=t.trim().toLowerCase();return e&&e.replace(/[^a-z0-9\s-_]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").slice(0,60)||"document"}var A=new TextEncoder;function $(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function R(t){let e=t.reduce((i,u)=>i+u.length,0),n=new Uint8Array(e),r=0;for(let i of t)n.set(i,r),r+=i.length;return n}function K(){let t=new Uint32Array(256);for(let e=0;e<256;e++){let n=e;for(let r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;t[e]=n>>>0}return t}var N=K();function Y(t){let e=4294967295;for(let n=0;n<t.length;n++)e=N[(e^t[n])&255]^e>>>8;return(e^4294967295)>>>0}function q(t=new Date){let e=Math.max(1980,t.getFullYear()),n=t.getMonth()+1,r=t.getDate(),i=t.getHours(),u=t.getMinutes(),x=Math.floor(t.getSeconds()/2),c=e-1980<<9|n<<5|r,g=i<<11|u<<5|x;return{date:c,time:g}}function V(t){let e=[],n=[],r=q(new Date),i=0;for(let g of t){let h=A.encode(g.name),f=typeof g.data=="string"?A.encode(g.data):g.data,I=Y(f),U=new Uint8Array(30+h.length),l=new DataView(U.buffer);l.setUint32(0,67324752,!0),l.setUint16(4,20,!0),l.setUint16(6,0,!0),l.setUint16(8,0,!0),l.setUint16(10,r.time,!0),l.setUint16(12,r.date,!0),l.setUint32(14,I,!0),l.setUint32(18,f.length,!0),l.setUint32(22,f.length,!0),l.setUint16(26,h.length,!0),l.setUint16(28,0,!0),U.set(h,30);let T=new Uint8Array(46+h.length),s=new DataView(T.buffer);s.setUint32(0,33639248,!0),s.setUint16(4,20,!0),s.setUint16(6,20,!0),s.setUint16(8,0,!0),s.setUint16(10,0,!0),s.setUint16(12,r.time,!0),s.setUint16(14,r.date,!0),s.setUint32(16,I,!0),s.setUint32(20,f.length,!0),s.setUint32(24,f.length,!0),s.setUint16(28,h.length,!0),s.setUint16(30,0,!0),s.setUint16(32,0,!0),s.setUint16(34,0,!0),s.setUint16(36,0,!0),s.setUint32(38,0,!0),s.setUint32(42,i,!0),T.set(h,46),e.push(U,f),n.push(T),i+=U.length+f.length}let u=R(n),x=new Uint8Array(22),c=new DataView(x.buffer);return c.setUint32(0,101010256,!0),c.setUint16(4,0,!0),c.setUint16(6,0,!0),c.setUint16(8,t.length,!0),c.setUint16(10,t.length,!0),c.setUint32(12,u.length,!0),c.setUint32(16,i,!0),c.setUint16(20,0,!0),R([...e,u,x])}function O(t,e){let r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wp14="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml" xmlns:wpg="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup" xmlns:wpi="http://schemas.microsoft.com/office/word/2010/wordprocessingInk" xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml" xmlns:wps="http://schemas.microsoft.com/office/word/2010/wordprocessingShape" mc:Ignorable="w14 wp14">
  <w:body>
    ${(e||"").replace(/\r\n/g,`
`).split(`
`).map(g=>`<w:p><w:r><w:t xml:space="preserve">${$(g)}</w:t></w:r></w:p>`).join("")||"<w:p />"}
    <w:sectPr>
      <w:pgSz w:w="12240" w:h="15840" />
      <w:pgMar w:top="1440" w:right="1440" w:bottom="1440" w:left="1440" w:header="708" w:footer="708" w:gutter="0"/>
      <w:cols w:space="708"/>
      <w:docGrid w:linePitch="360"/>
    </w:sectPr>
  </w:body>
</w:document>`,i=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
  <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
  <Default Extension="xml" ContentType="application/xml"/>
  <Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>
</Types>`,u=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>
</Relationships>`,x=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <dc:title>${$(t||"Untitled Document")}</dc:title>
</cp:coreProperties>`,c=V([{name:"[Content_Types].xml",data:i},{name:"_rels/.rels",data:u},{name:"docProps/core.xml",data:x},{name:"word/document.xml",data:r}]);return new Blob([c],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"})}var H=document.getElementById("app")||document.body;H.innerHTML=`
  <style>${B}</style>
  <div class="app-shell">
    <div class="topbar">
      <div class="brand"><span class="brand-badge">W</span> Word Lite</div>
      <div class="doc-meta">
        <label for="doc-title" class="muted">Title</label>
        <input id="doc-title" type="text" placeholder="Untitled Document" maxlength="100" />
      </div>
    </div>

    <div class="toolbar">
      <div class="group">
        <button data-cmd="bold"><b>B</b></button>
        <button data-cmd="italic"><i>I</i></button>
        <button data-cmd="underline"><u>U</u></button>
      </div>

      <div class="group">
        <select id="format-block" title="Style">
          <option value="P">Paragraph</option>
          <option value="H1">Heading 1</option>
          <option value="H2">Heading 2</option>
          <option value="H3">Heading 3</option>
          <option value="BLOCKQUOTE">Quote</option>
        </select>
      </div>

      <div class="group">
        <button data-cmd="justifyLeft">Left</button>
        <button data-cmd="justifyCenter">Center</button>
        <button data-cmd="justifyRight">Right</button>
        <button data-cmd="insertUnorderedList">\u2022 List</button>
        <button data-cmd="insertOrderedList">1. List</button>
      </div>

      <div class="group">
        <button id="btn-link">Link</button>
        <button data-cmd="removeFormat">Clear</button>
        <button data-cmd="undo">Undo</button>
        <button data-cmd="redo">Redo</button>
      </div>

      <div class="group">
        <button id="btn-new">New</button>
        <button id="btn-open">Open</button>
        <button id="btn-save" class="primary">Save</button>
        <button id="btn-export-txt">.txt</button>
        <button id="btn-export-html">.html</button>
        <button id="btn-export-docx">.docx</button>
        <button id="btn-focus">Focus</button>
      </div>
    </div>

    <div class="editor-wrap">
      <article id="editor" class="page" contenteditable="true" spellcheck="true" data-placeholder="Start typing..."></article>
      <input id="file-input" type="file" accept=".txt,.html,.htm" style="display:none" />
    </div>

    <div class="statusbar">
      <span id="stats">0 words \u2022 0 chars</span>
      <span id="save-state">Not saved</span>
    </div>
  </div>
`;var o=document.getElementById("editor"),v=document.getElementById("file-input"),W=document.getElementById("stats"),a=document.getElementById("save-state"),j=document.getElementById("format-block"),d=document.getElementById("doc-title"),b=!1,y=()=>(d.value||"").trim()||"Untitled Document",S=()=>F(y()),w=(t,e)=>{o.focus(),document.execCommand(t,!1,e),m()},m=()=>{let{words:t,chars:e}=D(o.innerText||""),n=t===0?0:Math.max(1,Math.ceil(t/200));W.textContent=`${t} words \u2022 ${e} chars \u2022 ${n} min read`},p=()=>{let t={html:o.innerHTML,title:y(),savedAt:Date.now()};localStorage.setItem(E,JSON.stringify(t)),a.textContent=`Saved at ${L()}`},G=P(()=>{p()},550),X=()=>{let t=localStorage.getItem(E);if(t){try{let e=JSON.parse(t);o.innerHTML=e.html||"<h1>Untitled Document</h1><p></p>",d.value=e.title||"Untitled Document"}catch{o.innerHTML=t,d.value="Untitled Document"}a.textContent="Loaded saved draft"}else{let e=localStorage.getItem(k);e?(o.innerHTML=e,d.value="Untitled Document",a.textContent="Loaded saved draft",p(),localStorage.removeItem(k)):(o.innerHTML="<h1>Untitled Document</h1><p></p>",d.value="Untitled Document",a.textContent="New document")}m()};for(let t of Array.from(document.querySelectorAll("button[data-cmd]")))t.addEventListener("click",()=>{let e=t.dataset.cmd;w(e)});j.addEventListener("change",()=>{w("formatBlock",j.value)});document.getElementById("btn-link")?.addEventListener("click",()=>{let t=prompt("Enter URL (https://...)");t&&w("createLink",t)});document.getElementById("btn-new")?.addEventListener("click",()=>{confirm("Start a new blank document?")&&(o.innerHTML="<p></p>",d.value="Untitled Document",m(),a.textContent="Unsaved new document",o.focus())});document.getElementById("btn-open")?.addEventListener("click",()=>{v.value="",v.click()});document.getElementById("btn-save")?.addEventListener("click",()=>{p()});document.getElementById("btn-focus")?.addEventListener("click",()=>{b=!b,H.classList.toggle("focus-mode",b),a.textContent=b?"Focus mode enabled":"Focus mode disabled"});document.getElementById("btn-export-txt")?.addEventListener("click",()=>{M(`${S()}.txt`,o.innerText||"","text/plain;charset=utf-8")});document.getElementById("btn-export-html")?.addEventListener("click",()=>{let e=`<!doctype html><html><head><meta charset="utf-8"><title>${y()}</title></head><body>${o.innerHTML}</body></html>`;M(`${S()}.html`,e,"text/html;charset=utf-8")});document.getElementById("btn-export-docx")?.addEventListener("click",()=>{let t=O(y(),o.innerText||"");C(`${S()}.docx`,t),a.textContent=`Exported .docx at ${L()}`});v.addEventListener("change",async()=>{let t=v.files?.[0];if(!t)return;let e=await t.text();if(/\.html?$/i.test(t.name))o.innerHTML=e;else{let n=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");o.innerHTML=`<p>${n}</p>`}d.value=t.name.replace(/\.[^/.]+$/,"")||"Untitled Document",m(),a.textContent=`Opened ${t.name}`,p()});o.addEventListener("input",()=>{m(),a.textContent="Editing\u2026",G()});d.addEventListener("input",()=>{a.textContent="Editing title\u2026",G()});o.addEventListener("keyup",m);var J=t=>{if(t)try{let e=new URL(t,window.location.href);if(!["http:","https:","mailto:","tel:"].includes(e.protocol)){alert(`Unsupported link protocol: ${e.protocol}`);return}window.open(e.href,"_blank","noopener,noreferrer")}catch{alert("Invalid URL")}};o.addEventListener("click",t=>{let n=t.target?.closest("a");n&&(t.preventDefault(),J(n.getAttribute("href")))});document.addEventListener("keydown",t=>{if(t.key==="Escape"&&b){b=!1,H.classList.remove("focus-mode"),a.textContent="Focus mode disabled";return}if(!t.ctrlKey&&!t.metaKey)return;let e=t.key.toLowerCase();e==="s"?(t.preventDefault(),p()):e==="b"?(t.preventDefault(),w("bold")):e==="i"?(t.preventDefault(),w("italic")):e==="u"?(t.preventDefault(),w("underline")):e==="o"?(t.preventDefault(),v.value="",v.click()):e==="n"&&(t.preventDefault(),o.innerHTML="<p></p>",d.value="Untitled Document",m(),a.textContent="Unsaved new document",o.focus())});X();o.focus();var z=window.yaar?.app;function _(t){let e=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");o.innerHTML=`<p>${e}</p>`,m()}z&&z.register({appId:"word-lite",name:"Word Lite",state:{html:{description:"Current document HTML content",handler:()=>o.innerHTML},text:{description:"Current document plain text content",handler:()=>o.innerText||""},stats:{description:"Current text stats as { words, chars }",handler:()=>D(o.innerText||"")},title:{description:"Current document title",handler:()=>y()},saveState:{description:"Current save status label",handler:()=>a.textContent||""}},commands:{setHtml:{description:"Replace document with HTML. Params: { html: string }",params:{type:"object",properties:{html:{type:"string"}},required:["html"]},handler:t=>(o.innerHTML=t.html||"<p></p>",m(),a.textContent="Updated via app protocol",p(),{ok:!0})},setTitle:{description:"Update document title. Params: { title: string }",params:{type:"object",properties:{title:{type:"string"}},required:["title"]},handler:t=>(d.value=(t.title||"").trim()||"Untitled Document",a.textContent="Updated via app protocol",p(),{ok:!0})},setText:{description:"Replace document with plain text. Params: { text: string }",params:{type:"object",properties:{text:{type:"string"}},required:["text"]},handler:t=>(_(t.text||""),a.textContent="Updated via app protocol",p(),{ok:!0})},appendText:{description:"Append plain text to the document. Params: { text: string, newline?: boolean }",params:{type:"object",properties:{text:{type:"string"},newline:{type:"boolean"}},required:["text"]},handler:t=>{let e=o.innerText||"",n=t.newline===!1?`${e}${t.text}`:`${e}${e?`
`:""}${t.text}`;return _(n),a.textContent="Updated via app protocol",p(),{ok:!0}}},newDocument:{description:"Clear current document to a blank paragraph. Params: {}",params:{type:"object",properties:{}},handler:()=>(o.innerHTML="<p></p>",d.value="Untitled Document",m(),a.textContent="Unsaved new document",{ok:!0})},saveDraft:{description:"Save current document to local draft storage. Params: {}",params:{type:"object",properties:{}},handler:()=>(p(),{ok:!0,savedAt:L()})}}});

</script>
</body>
</html>
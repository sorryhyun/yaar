# YAAR

**Y**ou **A**re **A**bsolutely **R**ight — AI가 다음에 무엇을 보여주고 할지 스스로 결정하는 리액티브 AI 인터페이스.

미리 만들어진 화면 없이, **항상 준비된 입력창** 하나만 있으면 됩니다. AI가 사용자의 의도에 따라 윈도우, 테이블, 폼, 시각화를 동적으로 생성합니다.

> [English version](./README.en.md)

## 작동 방식

```
┌─────────────────────────────────────────────────────────────────┐
│                          프론트엔드                               │
│   ┌─────────────┐    ┌──────────────┐    ┌──────────────────┐  │
│   │   입력창     │    │   캔버스      │    │    윈도우         │  │
│   │             │    │   (그리기)    │    │   (렌더링)       │  │
│   └──────┬──────┘    └──────┬───────┘    └────────▲─────────┘  │
│          │                  │                     │             │
│          └────────┬─────────┘                     │             │
│                   ▼                               │             │
│            사용자 메시지                    OS Actions (JSON)    │
│                   │                               │             │
└───────────────────┼───────────────────────────────┼─────────────┘
                    │          WebSocket            │
┌───────────────────▼───────────────────────────────┼─────────────┐
│                          서버                      │             │
│   ┌───────────────────────────────────────────────┴──────────┐  │
│   │                      AI 프로바이더                         │  │
│   │   • 사용자 의도를 해석                                     │  │
│   │   • 동적 컨텍스트 주입 (앱, 히스토리)                       │  │
│   │   • OS Actions 생성 → 프론트엔드가 렌더링                   │  │
│   └──────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

## 주요 기능

### 1. AI가 해석하고 렌더링

AI는 단순히 텍스트로 응답하지 않고 **UI를 직접 생성**합니다. 할 일 목록을 요청하면 체크박스가 있는 윈도우가 나타나고, 데이터 비교를 요청하면 테이블이 렌더링됩니다. 인터페이스가 의도에 맞춰 적응합니다.

```
사용자: "오늘 할 일 보여줘"
   AI: 인터랙티브 할 일 목록이 담긴 윈도우 생성
사용자: "이 두 파일 비교해줘"
   AI: 나란히 보는 diff 뷰 생성
```

### 2. 그려서 보내기

`Alt + 좌클릭 드래그`로 화면 어디서든 스케치할 수 있습니다. 와이어프레임, 다이어그램, 간단한 메모를 그리고 AI에게 보내면 그림을 해석해서 코드를 생성하거나, 개념을 설명하거나, 디자인을 다듬어 줍니다.

### 3. 리로드 (빠른 응답)

윈도우 내용이 변경될 필요가 있을 때, AI에게 다시 물어보지 않고 캐시된 컨텐츠를 즉시 복원합니다. 핑거프린트 기반 캐시로 동일한 내용은 AI 재호출 없이 빠르게 표시됩니다.

### 4. 동적 컨텍스트 주입

하고 있는 작업에 따라 컨텍스트가 자동으로 주입됩니다:
- 앱 아이콘 클릭 → AI가 해당 앱의 `SKILL.md` 로드
- 윈도우와 상호작용 → AI가 상호작용 컨텍스트 수신
- 이전 결과 참조 → AI가 대화 히스토리 보유

따로 설명하지 않아도 AI가 항상 관련 정보를 파악합니다.

### 5. 앱 개발

"테트리스 만들어줘"라고 말하면 AI가 TypeScript를 작성하고, esbuild로 컴파일하고, 바탕화면에 배포합니다. npm 설치 없이 사용 가능한 번들 라이브러리(lodash, anime.js, Konva 등)를 포함하며, 격리된 샌드박스에서 코드를 실행합니다.

외부 API를 활용하는 앱은 `SKILL.md`에 API 사용법을 기술하면 AI가 호출합니다.

자세한 내용은 [앱 개발 가이드](./docs/app-development.md)를 참고하세요.

## 세션, 모니터, 윈도우

YAAR의 런타임은 세 단계의 중첩 구조로 구성됩니다.

```
세션 (Session)
├── 모니터 0 ("데스크톱 1")
│   ├── 메인 에이전트 (순차, 바쁘면 임시 에이전트로 오버플로)
│   ├── 윈도우 A ─── 윈도우 에이전트 (병렬)
│   ├── 윈도우 B ─── 윈도우 에이전트 (병렬)
│   └── CLI 히스토리
├── 모니터 1 ("데스크톱 2")
│   ├── 메인 에이전트 (독립, 동일 오버플로 방식)
│   ├── 윈도우 C ─── 윈도우 에이전트 (병렬)
│   └── CLI 히스토리
└── 이벤트 로그 (messages.jsonl)
```

### 세션 — 연결을 넘어서는 지속성

**세션**은 하나의 대화 전체를 담는 최상위 컨테이너입니다. 에이전트, 윈도우, 컨텍스트 히스토리 등 모든 상태를 소유합니다. 브라우저 탭을 닫아도 세션은 유지되며, `?sessionId=X`로 재접속하면 기존 상태를 그대로 복원합니다. 여러 탭이 같은 세션을 공유할 수도 있습니다.

### 모니터 — 독립적인 병렬 워크스페이스

**모니터**는 세션 안의 가상 데스크톱입니다 (최대 4개). 각 모니터는 자체 메인 에이전트와 메시지 큐를 가지고 있어 완전히 독립적으로 동작합니다. 모니터 1에서 긴 작업을 실행하면서 모니터 0에서 다른 작업을 계속할 수 있습니다. `Ctrl+1`~`Ctrl+9`로 전환합니다.

메인 에이전트가 작업 중일 때 새 메시지가 들어오면 **임시 에이전트(ephemeral agent)**가 생성되어 병렬로 처리합니다. 임시 에이전트는 작업 완료 후 자동 폐기됩니다.

### 윈도우 — AI가 만드는 인터랙티브 UI

**윈도우**는 AI가 OS Action으로 생성하는 UI 표면입니다. 각 윈도우는 전용 **윈도우 에이전트**를 가질 수 있으며, 이 에이전트들은 메인 에이전트 및 다른 윈도우 에이전트와 **병렬로** 실행됩니다. 같은 윈도우에 대한 요청만 직렬화됩니다.

### 병렬 처리 요약

| 단위 | 처리 방식 | 설명 |
|------|-----------|------|
| 모니터 간 | **병렬** | 각 모니터의 메인 에이전트가 독립 실행 |
| 모니터 내 메인 큐 | **순차 + 오버플로** | 기본 순차, 메인 에이전트가 바쁘면 임시 에이전트가 병렬 처리 |
| 윈도우 에이전트 | **병렬** | 서로 다른 윈도우의 에이전트는 동시에 실행 |
| 같은 윈도우 내 | **순차** | 하나의 윈도우에 대한 작업은 직렬화 |

자세한 내용은 [`docs/monitor_and_windows_guide.md`](./docs/monitor_and_windows_guide.md)를 참고하세요.

## 빠른 시작

**사전 요구사항:** Node.js >= 24, pnpm >= 10, Claude CLI (`npm install -g @anthropic-ai/claude-code && claude login`)

```bash
pnpm install    # 의존성 설치
make dev        # YAAR 시작
```

http://localhost:5173 접속

## 프로젝트 구조

```
yaar/
├── apps/              # 여기에 폴더를 넣으면 앱이 됩니다
├── packages/
│   ├── shared/        # OS Actions 타입
│   ├── server/        # WebSocket 서버 + AI 프로바이더
│   └── frontend/      # React 프론트엔드
```

개발 관련 상세 내용은 [CLAUDE.md](./CLAUDE.md)를 참고하세요.
